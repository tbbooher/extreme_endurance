(function(){function a(a){return{x:a[0],y:a[1]}}function b(a,c,d,e,f,g){if(!a(c,d,e,f,g)){var h=(d+f)*.5,i=(e+g)*.5,j=c.nodes;j[0]&&b(a,j[0],d,e,h,i),j[1]&&b(a,j[1],h,e,f,i),j[2]&&b(a,j[2],d,i,h,g),j[3]&&b(a,j[3],h,i,f,g)}}function c(){return{leaf:!0,nodes:[],point:null}}function d(a,b){var c={list:a.map(function(a,b){return{index:b,x:a[0],y:a[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null},d={list:[],leftEnd:null,rightEnd:null,init:function(){d.leftEnd=d.createHalfEdge(null,"l"),d.rightEnd=d.createHalfEdge(null,"l"),d.leftEnd.r=d.rightEnd,d.rightEnd.l=d.leftEnd,d.list.unshift(d.leftEnd,d.rightEnd)},createHalfEdge:function(a,b){return{edge:a,side:b,vertex:null,l:null,r:null}},insert:function(a,b){b.l=a,b.r=a.r,a.r.l=b,a.r=b},leftBound:function(a){var b=d.leftEnd;do b=b.r;while(b!=d.rightEnd&&e.rightOf(b,a));return b=b.l,b},del:function(a){a.l.r=a.r,a.r.l=a.l,a.edge=null},right:function(a){return a.r},left:function(a){return a.l},leftRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[a.side]},rightRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[k[a.side]]}},e={bisect:function(a,b){var c={region:{l:a,r:b},ep:{l:null,r:null}},d=b.x-a.x,e=b.y-a.y,f=d>0?d:-d,g=e>0?e:-e;return c.c=a.x*d+a.y*e+(d*d+e*e)*.5,f>g?(c.a=1,c.b=e/d,c.c/=d):(c.b=1,c.a=d/e,c.c/=e),c},intersect:function(a,b){var c=a.edge,d=b.edge;if(!c||!d||c.region.r==d.region.r)return null;var e=c.a*d.b-c.b*d.a;if(Math.abs(e)<1e-10)return null;var f=(c.c*d.b-d.c*c.b)/e,g=(d.c*c.a-c.c*d.a)/e,h=c.region.r,i=d.region.r,j,k;h.y<i.y||h.y==i.y&&h.x<i.x?(j=a,k=c):(j=b,k=d);var l=f>=k.region.r.x;return l&&j.side==="l"||!l&&j.side==="r"?null:{x:f,y:g}},rightOf:function(a,b){var c=a.edge,d=c.region.r,e=b.x>d.x;if(e&&a.side==="l")return 1;if(!e&&a.side==="r")return 0;if(c.a===1){var f=b.y-d.y,g=b.x-d.x,h=0,i=0;!e&&c.b<0||e&&c.b>=0?i=h=f>=c.b*g:(i=b.x+b.y*c.b>c.c,c.b<0&&(i=!i),i||(h=1));if(!h){var j=d.x-c.region.l.x;i=c.b*(g*g-f*f)<j*f*(1+2*g/j+c.b*c.b),c.b<0&&(i=!i)}}else{var k=c.c-c.a*b.x,l=b.y-k,m=b.x-d.x,n=k-d.y;i=l*l>m*m+n*n}return a.side==="l"?i:!i},endPoint:function(a,c,d){a.ep[c]=d,!a.ep[k[c]]||b(a)},distance:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}},f={list:[],insert:function(a,b,c){a.vertex=b,a.ystar=b.y+c;for(var d=0,e=f.list,g=e.length;d<g;d++){var h=e[d];if(a.ystar>h.ystar||a.ystar==h.ystar&&b.x>h.vertex.x)continue;break}e.splice(d,0,a)},del:function(a){for(var b=0,c=f.list,d=c.length;b<d&&c[b]!=a;++b);c.splice(b,1)},empty:function(){return f.list.length===0},nextEvent:function(a){for(var b=0,c=f.list,d=c.length;b<d;++b)if(c[b]==a)return c[b+1];return null},min:function(){var a=f.list[0];return{x:a.vertex.x,y:a.ystar}},extractMin:function(){return f.list.shift()}};d.init(),c.bottomSite=c.list.shift();var g=c.list.shift(),h,i,j,l,m,n,o,p,q,r,s,t,u;for(;;){f.empty()||(h=f.min());if(g&&(f.empty()||g.y<h.y||g.y==h.y&&g.x<h.x))i=d.leftBound(g),j=d.right(i),o=d.rightRegion(i),t=e.bisect(o,g),n=d.createHalfEdge(t,"l"),d.insert(i,n),r=e.intersect(i,n),r&&(f.del(i),f.insert(i,r,e.distance(r,g))),i=n,n=d.createHalfEdge(t,"r"),d.insert(i,n),r=e.intersect(n,j),r&&f.insert(n,r,e.distance(r,g)),g=c.list.shift();else if(!f.empty())i=f.extractMin(),l=d.left(i),j=d.right(i),m=d.right(j),o=d.leftRegion(i),p=d.rightRegion(j),s=i.vertex,e.endPoint(i.edge,i.side,s),e.endPoint(j.edge,j.side,s),d.del(i),f.del(j),d.del(j),u="l",o.y>p.y&&(q=o,o=p,p=q,u="r"),t=e.bisect(o,p),n=d.createHalfEdge(t,u),d.insert(l,n),e.endPoint(t,k[u],s),r=e.intersect(l,n),r&&(f.del(l),f.insert(l,r,e.distance(r,o))),r=e.intersect(n,m),r&&f.insert(n,r,e.distance(r,o));else break}for(i=d.right(d.leftEnd);i!=d.rightEnd;i=d.right(i))b(i.edge)}function e(a,b,c,d){var e=a[0],f=b[0],g=c[0],h=d[0],i=a[1],j=b[1],k=c[1],l=d[1],m=e-g,n=f-e,o=h-g,p=i-k,q=j-i,r=l-k,s=(o*p-r*m)/(r*n-o*q);return[e+s*n,i+s*q]}function f(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function g(a,b,c,d){var e,f,g,h,i,j,k;return e=d[a],f=e[0],g=e[1],e=d[b],h=e[0],i=e[1],e=d[c],j=e[0],k=e[1],(k-g)*(h-f)-(i-g)*(j-f)>0}function h(a){var b=0,c=0;for(;;){if(a(b,c))return[b,c];b===0?(b=c+1,c=0):(b=b-1,c=c+1)}}d3.geom={},d3.geom.contour=function(a,b){var c=b||h(a),d=[],e=c[0],f=c[1],g=0,k=0,l=NaN,m=NaN,n=0;do n=0,a(e-1,f-1)&&(n+=1),a(e,f-1)&&(n+=2),a(e-1,f)&&(n+=4),a(e,f)&&(n+=8),n===6?(g=m===-1?-1:1,k=0):n===9?(g=0,k=l===1?-1:1):(g=i[n],k=j[n]),g!=l&&k!=m&&(d.push([e,f]),l=g,m=k),e+=g,f+=k;while(c[0]!=e||c[1]!=f);return d};var i=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],j=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(a){if(a.length<3)return[];var b=a.length,c=b-1,d=[],e=[],f,h,i=0,j,k,l,m,n,o,p,q;for(f=1;f<b;++f)a[f][1]<a[i][1]?i=f:a[f][1]==a[i][1]&&(i=a[f][0]<a[i][0]?f:i);for(f=0;f<b;++f){if(f===i)continue;k=a[f][1]-a[i][1],j=a[f][0]-a[i][0],d.push({angle:Math.atan2(k,j),index:f})}d.sort(function(a,b){return a.angle-b.angle}),p=d[0].angle,o=d[0].index,n=0;for(f=1;f<c;++f)h=d[f].index,p==d[f].angle?(j=a[o][0]-a[i][0],k=a[o][1]-a[i][1],l=a[h][0]-a[i][0],m=a[h][1]-a[i][1],j*j+k*k>=l*l+m*m?d[f].index=-1:(d[n].index=-1,p=d[f].angle,n=f,o=h)):(p=d[f].angle,n=f,o=h);e.push(i);for(f=0,h=0;f<2;++h)d[h].index!==-1&&(e.push(d[h].index),f++);q=e.length;for(;h<c;++h){if(d[h].index===-1)continue;while(!g(e[q-2],e[q-1],d[h].index,a))--q;e[q++]=d[h].index}var r=[];for(f=0;f<q;++f)r.push(a[e[f]]);return r},d3.geom.polygon=function(a){return a.area=function(){var b=0,c=a.length,d=a[c-1][0]*a[0][1],e=a[c-1][1]*a[0][0];while(++b<c)d+=a[b-1][0]*a[b][1],e+=a[b-1][1]*a[b][0];return(e-d)*.5},a.centroid=function(b){var c=-1,d=a.length-1,e=0,f=0,g,h,i;arguments.length||(b=1/(6*a.area()));while(++c<d)g=a[c],h=a[c+1],i=g[0]*h[1]-h[0]*g[1],e+=(g[0]+h[0])*i,f+=(g[1]+h[1])*i;return[e*b,f*b]},a.clip=function(b){var c,d=-1,g=a.length,h,i,j=a[g-1],k,l,m;while(++d<g){c=b.slice(),b.length=0,k=a[d],l=c[(i=c.length)-1],h=-1;while(++h<i)m=c[h],f(m,j,k)?(f(l,j,k)||b.push(e(l,m,j,k)),b.push(m)):f(l,j,k)&&b.push(e(l,m,j,k)),l=m;j=k}return b},a},d3.geom.voronoi=function(a){var b=a.map(function(){return[]});return d(a,function(a){var c,d,e,f,g,h;a.a===1&&a.b>=0?(c=a.ep.r,d=a.ep.l):(c=a.ep.l,d=a.ep.r),a.a===1?(g=c?c.y:-1e6,e=a.c-a.b*g,h=d?d.y:1e6,f=a.c-a.b*h):(e=c?c.x:-1e6,g=a.c-a.a*e,f=d?d.x:1e6,h=a.c-a.a*f);var i=[e,g],j=[f,h];b[a.region.l.index].push(i,j),b[a.region.r.index].push(i,j)}),b.map(function(b,c){var d=a[c][0],e=a[c][1];return b.forEach(function(a){a.angle=Math.atan2(a[0]-d,a[1]-e)}),b.sort(function(a,b){return a.angle-b.angle}).filter(function(a,c){return!c||a.angle-b[c-1].angle>1e-10})})};var k={l:"r",r:"l"};d3.geom.delaunay=function(a){var b=a.map(function(){return[]}),c=[];return d(a,function(c){b[c.region.l.index].push(a[c.region.r.index])}),b.forEach(function(b,d){var e=a[d],f=e[0],g=e[1];b.forEach(function(a){a.angle=Math.atan2(a[0]-f,a[1]-g)}),b.sort(function(a,b){return a.angle-b.angle});for(var h=0,i=b.length-1;h<i;h++)c.push([e,b[h],b[h+1]])}),c},d3.geom.quadtree=function(d,e,f,g,h){function i(a,b,d,e,f,g){var h=(d+f)*.5,i=(e+g)*.5,k=b.x>=h,l=b.y>=i,m=(l<<1)+k;a.leaf=!1,a=a.nodes[m]||(a.nodes[m]=c()),k?d=h:f=h,l?e=i:g=i,j(a,b,d,e,f,g)}function j(a,b,c,d,e,f){if(!isNaN(b.x)&&!isNaN(b.y))if(a.leaf){var g=a.point;g?Math.abs(g.x-b.x)+Math.abs(g.y-b.y)<.01?i(a,b,c,d,e,f):(a.point=null,i(a,g,c,d,e,f),i(a,b,c,d,e,f)):a.point=b}else i(a,b,c,d,e,f)}var k,l=-1,m=d.length;m&&isNaN(d[0].x)&&(d=d.map(a));if(arguments.length<5)if(arguments.length===3)h=g=f,f=e;else{e=f=Infinity,g=h=-Infinity;while(++l<m)k=d[l],k.x<e&&(e=k.x),k.y<f&&(f=k.y),k.x>g&&(g=k.x),k.y>h&&(h=k.y);var n=g-e,o=h-f;n>o?h=f+n:g=e+o}var p=c();return p.add=function(a){j(p,a,e,f,g,h)},p.visit=function(a){b(a,p,e,f,g,h)},d.forEach(p.add),p}})()